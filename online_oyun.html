<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GÄ°ZLÄ° GÃ–REV: MEGA PAKET ğŸ•µï¸â€â™‚ï¸</title>
    <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&family=Black+Ops+One&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <style>
        /* --- TEMA: CYBERPUNK / HACKER --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background-color: #050505; 
            color: #0f0;
            font-family: 'Share Tech Mono', monospace;
            height: 100vh;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            overflow: hidden;
            background-image: linear-gradient(rgba(0, 255, 0, 0.03) 1px, transparent 1px),
            linear-gradient(90deg, rgba(0, 255, 0, 0.03) 1px, transparent 1px);
            background-size: 20px 20px;
        }

        /* Glitch Efekti */
        @keyframes glitch {
            0% { transform: translate(0) }
            20% { transform: translate(-2px, 2px) }
            40% { transform: translate(-2px, -2px) }
            60% { transform: translate(2px, 2px) }
            80% { transform: translate(2px, -2px) }
            100% { transform: translate(0) }
        }

        .container {
            width: 95%; max-width: 600px;
            background: rgba(10, 10, 10, 0.95);
            border: 1px solid #333;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.2);
            padding: 15px;
            border-radius: 5px;
            position: relative;
            min-height: 500px;
            display: flex; flex-direction: column;
        }

        h1 {
            font-family: 'Black Ops One', cursive;
            color: #e63946; text-align: center; letter-spacing: 2px;
            margin-bottom: 10px; text-shadow: 0 0 10px rgba(230, 57, 70, 0.5);
            animation: glitch 2s infinite;
        }

        .status-bar {
            display: flex; justify-content: space-between;
            border-bottom: 1px solid #333; padding-bottom: 10px; margin-bottom: 15px;
            font-size: 0.9rem; color: #888;
        }
        .role-badge { color: #00e5ff; font-weight: bold; text-transform: uppercase; }

        .game-screen { flex-grow: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        .hidden { display: none !important; }

        /* Mesaj KutularÄ± */
        .message-box {
            background: #111; border: 1px solid #444;
            padding: 15px; margin-bottom: 20px; text-align: left;
            width: 100%; color: #eee; font-size: 0.95rem; line-height: 1.5;
            box-shadow: inset 0 0 20px rgba(0,0,0,1);
        }
        .agent-view { border-left: 4px solid #00e5ff; } 
        .analyst-view { border-left: 4px solid #d000ff; } 

        /* Butonlar & Girdiler */
        button {
            background: #1a1a1a; color: #0f0; border: 1px solid #0f0;
            padding: 15px; font-family: 'Share Tech Mono', monospace;
            font-size: 1.1rem; font-weight: bold; cursor: pointer;
            transition: 0.2s; margin-top: 10px; width: 100%;
            text-transform: uppercase; letter-spacing: 1px;
        }
        button:hover { background: #0f0; color: #000; box-shadow: 0 0 15px #0f0; }
        
        input {
            background: #000; border: 1px solid #333; color: #0f0;
            padding: 10px; width: 100%; font-family: 'Share Tech Mono', monospace;
            font-size: 1.5rem; text-align: center; letter-spacing: 3px; margin-bottom: 15px;
        }

        /* --- Ã–ZEL OYUN ELEMENTLERÄ° --- */
        
        /* 1. Binary Anahtarlar */
        .switch-container { display: flex; gap: 10px; margin: 20px 0; }
        .switch { 
            width: 50px; height: 50px; border: 2px solid #555; 
            display: flex; align-items: center; justify-content: center;
            font-size: 1.5rem; cursor: pointer; user-select: none;
            background: #222; color: #555;
        }
        .switch.active { border-color: #0f0; color: #0f0; background: #001a00; text-shadow: 0 0 10px #0f0; }

        /* 2. Renk TÃ¼pleri */
        .vial-container { display: flex; gap: 15px; margin: 20px 0; }
        .vial { 
            width: 40px; height: 80px; border: 2px solid #fff; border-radius: 0 0 20px 20px;
            position: relative; overflow: hidden; cursor: pointer;
        }
        .vial::after { content:''; position: absolute; bottom:0; left:0; width:100%; height: 0%; transition: 0.3s; }
        .vial.red::after { background: #ff3b3b; }
        .vial.green::after { background: #0f0; }
        .vial.blue::after { background: #00e5ff; }
        .vial.filled::after { height: 80%; }

        /* 3. Mors IÅŸÄ±ÄŸÄ± */
        .morse-light {
            width: 50px; height: 50px; border-radius: 50%; background: #333;
            margin: 20px auto; border: 2px solid #555;
            transition: 0.1s;
        }
        .morse-light.on { background: #fff; box-shadow: 0 0 30px #fff; border-color: #fff; }

        /* 4. Koordinat IzgarasÄ± */
        .grid-container { 
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; margin: 20px auto; width: 200px; 
        }
        .grid-cell {
            height: 50px; border: 1px solid #0f0; display: flex; align-items: center; justify-content: center;
            cursor: pointer; font-size: 1.2rem;
        }
        .grid-cell:hover { background: rgba(0, 255, 0, 0.2); }
        .grid-cell.selected { background: #0f0; color: #000; }

        .home-icon { position: absolute; top: 15px; right: 15px; text-decoration: none; font-size: 1.5rem; z-index: 100; filter: grayscale(100%); transition: 0.3s; }
        .home-icon:hover { filter: grayscale(0%); transform: scale(1.1); }
        
        .success-anim { animation: pop 0.5s ease-out; color: #0f0; font-size: 2rem; position: absolute; }
        @keyframes pop { 0% { transform: scale(0); opacity: 0; } 50% { transform: scale(1.2); opacity: 1; } 100% { transform: scale(1); opacity: 0; } }

    </style>
</head>
<body>

    <a href="index.html" class="home-icon">ğŸ </a>

    <div class="container">
        <h1>GÄ°ZLÄ° DOSYA: MEGA</h1>

        <div id="statusBar" class="status-bar hidden">
            <span>AJAN: <span id="playerRole" class="role-badge">...</span></span>
            <span>BÃ–LÃœM: <span id="levelIndicator">1</span>/10</span>
        </div>

        <div id="loginScreen" class="game-screen">
            <p style="margin-bottom: 20px; font-size: 1.1rem; color:#0f0;">SÄ°STEME BAÄLANILIYOR...</p>
            
            <button onclick="selectRole('onur')" style="border-left: 5px solid #00e5ff;">BEN ONUR (SAHA AJANI)</button>
            <p style="font-size: 0.7rem; color:#666; margin: 5px 0 20px;">Fiziksel mÃ¼dahale yetkisi.</p>

            <button onclick="selectRole('ozlem')" style="border-left: 5px solid #d000ff;">BEN Ã–ZLEM (HACKER)</button>
            <p style="font-size: 0.7rem; color:#666; margin: 5px 0;">Veri akÄ±ÅŸÄ± ve ÅŸifre Ã§Ã¶zme.</p>
        </div>

        <div id="lobbyScreen" class="game-screen hidden">
            <h2 style="color: #fca311;">AÄ BEKLENÄ°YOR...</h2>
            <div style="width: 50px; height: 50px; border: 5px solid #333; border-top-color: #fca311; border-radius: 50%; animation: spin 1s infinite; margin: 20px auto;"></div>
            <p id="lobbyStatus" style="margin-top: 10px; font-size: 0.8rem; color: #00e5ff;">...</p>
            <button onclick="resetGame()" style="margin-top: 50px; border-color: #333; color: #555; font-size: 0.7rem;">Sistemi Resetle (Acil)</button>
        </div>
        <style>@keyframes spin { 100% { transform: rotate(360deg); } }</style>

        <div id="gameContent" class="game-screen hidden"></div>

        <div id="victoryScreen" class="game-screen hidden">
            <h1 style="color: #00ff88; text-shadow: 0 0 20px #00ff88;">GÃ–REV TAMAMLANDI</h1>
            <p>10 BÃ¶lÃ¼mlÃ¼k Ä°mkansÄ±z GÃ¶rev BaÅŸarÄ±ldÄ±.</p>
            <p style="margin-top: 20px; font-size: 2rem;">ğŸ†</p>
            <p style="margin-top: 20px; color: #ccc;">Onur & Ã–zlem: Efsane TakÄ±m</p>
            <button onclick="resetGame()">BAÅA SAR</button>
        </div>
    </div>

    <script>
        // ============================================================
        // ğŸ”¥ BURAYA KENDÄ° FIREBASE AYARLARINI YAPIÅTIRMAYI UNUTMA! ğŸ”¥
        // (Eski dosyadaki const firebaseConfig = {...} kÄ±smÄ±nÄ± al)
        // ============================================================
        
        // EÄER YAPISTIRMAZSAN Ã‡ALIÅMAZ! AÅAÄIDAKÄ° Ã–RNEKTÄ°R:
        const firebaseConfig = {
            apiKey: "AIzaSyBHejjQe2dHnwDYES3Qd30HKO94-_D5lVA",
            authDomain: "ask-oyunu-5d368.firebaseapp.com",
            databaseURL: "https://ask-oyunu-5d368-default-rtdb.firebaseio.com",
            projectId: "ask-oyunu-5d368",
            storageBucket: "ask-oyunu-5d368.firebasestorage.app",
            messagingSenderId: "550862375128",
            appId: "1:550862375128:web:fb49cef5e3c5440d996fad",
            measurementId: "G-T1GCW04QD0"
        };
        // ============================================================

        try {
            firebase.initializeApp(firebaseConfig);
            const db = firebase.database();
            console.log("BaÄŸlandÄ±");
        } catch(e) {
            console.error(e);
        }

        const gameRef = firebase.database().ref('mega_game');
        let myRole = ""; 
        let currentLevel = 1;

        function selectRole(role) {
            myRole = role;
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('lobbyScreen').classList.remove('hidden');
            document.getElementById('statusBar').classList.remove('hidden');
            document.getElementById('playerRole').innerText = role.toUpperCase();
            document.getElementById('playerRole').style.color = role === 'onur' ? '#00e5ff' : '#d000ff';

            gameRef.child('players/' + role).set(true);
            listenToGame();
        }

        function listenToGame() {
            gameRef.child('level').on('value', (snapshot) => {
                const level = snapshot.val() || 1;
                currentLevel = level;
                document.getElementById('levelIndicator').innerText = level;
                if (level > 10) showScreen('victoryScreen'); // 10 BÃ–LÃœM
                else renderLevel(level);
            });

            gameRef.child('players').on('value', (snapshot) => {
                const players = snapshot.val();
                if (players && players.onur && players.ozlem) {
                    showScreen('gameContent');
                } else {
                    document.getElementById('lobbyStatus').innerText = 
                        myRole === 'onur' ? "Ã–zlem bekleniyor..." : "Onur bekleniyor...";
                }
            });
        }

        function showScreen(screenId) {
            ['loginScreen', 'lobbyScreen', 'gameContent', 'victoryScreen'].forEach(id => {
                document.getElementById(id).classList.add('hidden');
            });
            document.getElementById(screenId).classList.remove('hidden');
        }

        // --- BÃ–LÃœM TASARIMLARI (MEGA PAKET) ---
        function renderLevel(level) {
            const container = document.getElementById('gameContent');
            let html = "";
            const isOzlem = myRole === 'ozlem';

            // LEVEL 1: RADYO (KLASÄ°K)
            if (level === 1) {
                if (isOzlem) html = msgBox("analyst", "Radyo FrekansÄ±: 92.4 MHz", "Onur'a sÃ¶yle ayarlamasÄ± lazÄ±m.");
                else html = msgBox("agent", "Radyo Sinyali Gerekli", "Frekans kaÃ§?") + 
                    `<div style="font-size:2rem; color:#e63946" id="val1">88.0</div><input type="range" min="88" max="108" step="0.1" oninput="document.getElementById('val1').innerText=this.value; checkLvl1(this.value)">`;
            }
            // LEVEL 2: ÅÄ°FRE (TERS)
            else if (level === 2) {
                if (isOzlem) html = msgBox("analyst", "Åifre: 2025", "Ama klavye bozuk! RakamlarÄ± tersten girmeli.");
                else html = msgBox("agent", "KapÄ± Åifresi", "Ã–zlem kod nedir? (Dikkatli ol)") + `<input id="inp2" type="number" placeholder="____"><button onclick="checkLvl2()">GÄ°RÄ°Å</button>`;
            }
            // LEVEL 3: KABLO (RENK)
            else if (level === 3) {
                if (isOzlem) html = msgBox("analyst", "Bomba Ä°mha", "1. KÄ±rmÄ±zÄ± YASAK.\n2. YeÅŸil KESÄ°LMEZ.\n3. HEDEF: MAVÄ°.");
                else html = msgBox("agent", "Bomba KablolarÄ±", "Hangisini keseyim?") + `<div class="vial-container" style="justify-content:center"><button style="background:red;width:50px;" onclick="fail()">X</button><button style="background:blue;width:50px;" onclick="pass()">X</button><button style="background:green;width:50px;" onclick="fail()">X</button></div>`;
            }
            // LEVEL 4: BINARY (MATRÄ°X)
            else if (level === 4) {
                if (isOzlem) html = msgBox("analyst", "Binary Kod", "AnahtarlarÄ± ÅŸu sÄ±rayla aÃ§:\n\n1 - 0 - 1 - 1\n(AÃ§Ä±k - KapalÄ± - AÃ§Ä±k - AÃ§Ä±k)");
                else html = msgBox("agent", "Sunucu AnahtarlarÄ±", "Hangi ÅŸalterler kalkacak?") + 
                    `<div class="switch-container">
                        <div id="sw1" class="switch" onclick="toggle(1)">0</div>
                        <div id="sw2" class="switch" onclick="toggle(2)">0</div>
                        <div id="sw3" class="switch" onclick="toggle(3)">0</div>
                        <div id="sw4" class="switch" onclick="toggle(4)">0</div>
                     </div><button onclick="checkLvl4()">KONTROL ET</button>`;
            }
            // LEVEL 5: MORS ALFABESÄ° (IÅIK)
            else if (level === 5) {
                if (isOzlem) html = msgBox("analyst", "Mors Åifresi", "Uzun Yanma = Ã‡izgi (-)\nKÄ±sa Yanma = Nokta (.)\n\nÅifre: S O S (... --- ...)") + `<div class="morse-light" id="mlight"></div><button onclick="playMorse()">IÅIÄI GÃ–NDER</button>`;
                else html = msgBox("agent", "IÅŸÄ±klÄ± Mesaj", "Ã–zlem sana bir Ä±ÅŸÄ±k sinyali gÃ¶nderecek. Ne diyor?") + `<input id="inp5" style="text-transform:uppercase" placeholder="MESAJ"><button onclick="checkLvl5()">Ã‡Ã–Z</button>`;
            }
            // LEVEL 6: KÄ°MYASAL (SIRA)
            else if (level === 6) {
                if (isOzlem) html = msgBox("analyst", "Kimyasal FormÃ¼l", "KarÄ±ÅŸÄ±m SÄ±rasÄ±:\n1. KIRMIZI\n2. YEÅÄ°L\n3. MAVÄ°\n(SÄ±ra Ã¶nemli!)");
                else html = msgBox("agent", "Laboratuvar", "TÃ¼pleri hangi sÄ±rayla dÃ¶keyim?") + 
                    `<div class="vial-container" style="justify-content:center">
                        <div class="vial red" onclick="addMix('K')"></div>
                        <div class="vial green" onclick="addMix('Y')"></div>
                        <div class="vial blue" onclick="addMix('M')"></div>
                     </div><p id="mixRes">KarÄ±ÅŸÄ±m: </p><button onclick="checkLvl6()">KARIÅTIR</button><button onclick="mix=''">SIFIRLA</button>`;
            }
            // LEVEL 7: KOORDÄ°NAT (Ä°ZGARADA BULMA)
            else if (level === 7) {
                if (isOzlem) html = msgBox("analyst", "Hedef Konum", "Uydu gÃ¶rÃ¼ntÃ¼sÃ¼:\nHedefimiz B2 karesinde.");
                else html = msgBox("agent", "FÃ¼ze Kilitlenmesi", "Hedef hangi kare?") + 
                    `<div class="grid-container">
                        <div class="grid-cell" onclick="checkLvl7('A1')">A1</div><div class="grid-cell" onclick="checkLvl7('A2')">A2</div><div class="grid-cell" onclick="checkLvl7('A3')">A3</div>
                        <div class="grid-cell" onclick="checkLvl7('B1')">B1</div><div class="grid-cell" onclick="checkLvl7('B2')">B2</div><div class="grid-cell" onclick="checkLvl7('B3')">B3</div>
                    </div>`;
            }
            // LEVEL 8: MANTIK (RENK HESABI)
            else if (level === 8) {
                if (isOzlem) html = msgBox("analyst", "Renk HesabÄ±", "KÄ±rmÄ±zÄ± = 5\nMavi = 3\nKod = KÄ±rmÄ±zÄ± + Mavi");
                else html = msgBox("agent", "Matematiksel Kilit", "Kod kaÃ§?") + `<input id="inp8" type="number"><button onclick="checkLvl8()">GÄ°R</button>`;
            }
            // LEVEL 9: SESLÄ° KOMUT (YÃ–N)
            else if (level === 9) {
                if (isOzlem) html = msgBox("analyst", "Labirent HaritasÄ±", "Ã‡Ä±kÄ±ÅŸ yolu:\nSAÄ - SOL - SAÄ");
                else html = msgBox("agent", "KaranlÄ±k TÃ¼nel", "Hangi yÃ¶ne gitmeliyim?") + 
                    `<button onclick="addDir('SOL')">SOL â¬…ï¸</button><button onclick="addDir('SAÄ')">SAÄ â¡ï¸</button><p id="dirRes">Yol: </p><button onclick="checkLvl9()">GÄ°T</button><button onclick="dirs=''">SIFIRLA</button>`;
            }
            // LEVEL 10: FÄ°NAL (TARÄ°H)
            else if (level === 10) {
                if (isOzlem) html = msgBox("analyst", "SON GÃ–REV", "DÃ¼nyayÄ± kurtarmak iÃ§in o tarihi gir:\n17.03.2025");
                else html = msgBox("agent", "KIYAMET SAATÄ°", "Durdurma Kodu (Tarih):") + `<input id="inp10" placeholder="GG.AA.YYYY"><button onclick="checkLvl10()">DURDUR</button>`;
            }

            container.innerHTML = html;
        }

        // --- YARDIMCI FONKSÄ°YONLAR ---
        function msgBox(type, title, text) {
            return `<div class="message-box ${type === 'analyst' ? 'analyst-view' : 'agent-view'}"><h3>${title}</h3><pre style="font-family:inherit; white-space:pre-wrap">${text}</pre></div>`;
        }

        function pass() { nextLevel(); }
        function fail() { alert("HATA! Sistem Kilitlendi (Tekrar Dene)"); }
        
        function nextLevel() {
            gameRef.child('level').transaction(c => (c || 1) + 1);
        }

        function resetGame() {
            gameRef.set({ level: 1, players: { onur: false, ozlem: false } });
            location.reload();
        }

        // --- LEVEL MANTIKLARI ---
        // L1
        function checkLvl1(val) { if(val == 92.4) pass(); }
        // L2
        function checkLvl2() { if(document.getElementById('inp2').value == "5202") pass(); else fail(); }
        // L4
        let swState = [0,0,0,0];
        function toggle(id) { 
            swState[id-1] = swState[id-1] ? 0 : 1; 
            document.getElementById('sw'+id).innerText = swState[id-1];
            document.getElementById('sw'+id).classList.toggle('active');
        }
        function checkLvl4() { if(swState.join('') === "1011") pass(); else fail(); }
        // L5
        function playMorse() {
            const light = document.getElementById('mlight');
            const pattern = [200, 200, 200, 600, 600, 600, 200, 200, 200]; // SOS Timing
            let delay = 0;
            pattern.forEach((dur, i) => {
                setTimeout(() => { light.classList.add('on'); }, delay);
                setTimeout(() => { light.classList.remove('on'); }, delay + (i > 2 && i < 6 ? 600 : 200)); // Uzun/KÄ±sa yanma
                delay += (i > 2 && i < 6 ? 800 : 400);
            });
        }
        function checkLvl5() { if(document.getElementById('inp5').value.toUpperCase() === "SOS") pass(); else fail(); }
        // L6
        let mix = "";
        function addMix(c) { mix += c; document.getElementById('mixRes').innerText += c + " > "; }
        function checkLvl6() { if(mix === "KYM") pass(); else fail(); }
        // L7
        function checkLvl7(coord) { if(coord === "B2") pass(); else fail(); }
        // L8
        function checkLvl8() { if(document.getElementById('inp8').value == "8") pass(); else fail(); }
        // L9
        let dirs = "";
        function addDir(d) { dirs += d; document.getElementById('dirRes').innerText += d + " "; }
        function checkLvl9() { if(dirs === "SAÄSOLSAÄ") pass(); else fail(); }
        // L10
        function checkLvl10() { 
            const d = document.getElementById('inp10').value; 
            if(d === "17.03.2025" || d === "17/03/2025") pass(); else fail(); 
        }

    </script>
</body>
</html>