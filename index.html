<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GÄ°ZLÄ° GÃ–REV: 1923 ğŸ•µï¸â€â™‚ï¸</title>
    <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&family=Black+Ops+One&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <style>
        /* --- TEMA: GÄ°ZLÄ° AJAN / HACKER --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background-color: #0d0d0d; 
            color: #ccc;
            font-family: 'Courier Prime', monospace;
            height: 100vh;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            overflow: hidden;
            background-image: linear-gradient(0deg, transparent 24%, rgba(0, 255, 0, .03) 25%, rgba(0, 255, 0, .03) 26%, transparent 27%, transparent 74%, rgba(0, 255, 0, .03) 75%, rgba(0, 255, 0, .03) 76%, transparent 77%, transparent), linear-gradient(90deg, transparent 24%, rgba(0, 255, 0, .03) 25%, rgba(0, 255, 0, .03) 26%, transparent 27%, transparent 74%, rgba(0, 255, 0, .03) 75%, rgba(0, 255, 0, .03) 76%, transparent 77%, transparent);
            background-size: 50px 50px;
        }

        .container {
            width: 90%; max-width: 600px;
            background: rgba(20, 20, 20, 0.95);
            border: 2px solid #333;
            box-shadow: 0 0 30px rgba(0,0,0,0.8);
            padding: 20px;
            border-radius: 10px;
            position: relative;
            min-height: 400px;
            display: flex; flex-direction: column;
        }

        /* BaÅŸlÄ±k */
        h1 {
            font-family: 'Black Ops One', cursive;
            color: #e63946;
            text-align: center;
            letter-spacing: 2px;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(230, 57, 70, 0.5);
        }

        /* Durum Ã‡ubuÄŸu */
        .status-bar {
            display: flex; justify-content: space-between;
            border-bottom: 1px dashed #555;
            padding-bottom: 10px; margin-bottom: 20px;
            font-size: 0.8rem; color: #888;
        }
        .role-badge { color: #00e5ff; font-weight: bold; text-transform: uppercase; }

        /* Oyun AlanÄ± */
        .game-screen { flex-grow: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        .hidden { display: none !important; }

        /* Mesaj KutularÄ± */
        .message-box {
            background: #1a1a1a; border-left: 4px solid #fca311;
            padding: 15px; margin-bottom: 20px; text-align: left;
            width: 100%; color: #eee; font-size: 1rem; line-height: 1.5;
        }
        .agent-view { border-color: #00e5ff; } /* Mavi: Onur */
        .analyst-view { border-color: #d000ff; } /* Mor: Ã–zlem */

        /* Girdiler ve Butonlar */
        button {
            background: #333; color: #fff; border: 1px solid #555;
            padding: 12px 25px; font-family: 'Courier Prime', monospace;
            font-size: 1rem; font-weight: bold; cursor: pointer;
            transition: 0.3s; margin-top: 10px; width: 100%;
        }
        button:hover { background: #e63946; border-color: #e63946; color: #fff; }
        button:disabled { opacity: 0.5; cursor: not-allowed; background: #222; border-color: #333; }

        input {
            background: #000; border: 1px solid #444; color: #00e5ff;
            padding: 10px; width: 100%; font-family: 'Courier Prime', monospace;
            font-size: 1.5rem; text-align: center; letter-spacing: 5px; margin-bottom: 15px;
        }

        /* --- BULMACA Ã–ZEL EFEKTLERÄ° --- */
        /* Kablo Kesme */
        .wires-container { display: flex; gap: 15px; justify-content: center; margin: 20px 0; }
        .wire { width: 30px; height: 100px; border-radius: 5px; cursor: pointer; position: relative; border: 2px solid rgba(255,255,255,0.2); }
        .wire::after { content: ''; position: absolute; width: 100%; height: 100%; background: inherit; opacity: 0.6; }
        .wire.cut { height: 40px; margin-top: 30px; opacity: 0.3; cursor: default; }
        
        /* Radyo */
        .radio-display { font-size: 2.5rem; color: #e63946; font-family: 'Black Ops One'; margin-bottom: 10px; }
        input[type=range] { width: 100%; accent-color: #e63946; }

        .scan-line {
            width: 100%; height: 2px; background: rgba(0, 255, 0, 0.3);
            position: absolute; top: 0; left: 0; animation: scan 3s linear infinite; pointer-events: none;
        }
        @keyframes scan { 0% { top: 0%; } 100% { top: 100%; } }
        
        .home-icon { position: absolute; top: 15px; right: 15px; text-decoration: none; font-size: 1.5rem; z-index: 100; filter: grayscale(100%); transition: 0.3s; }
        .home-icon:hover { filter: grayscale(0%); transform: scale(1.1); }

    </style>
</head>
<body>

    <a href="index.html" class="home-icon">ğŸ </a>

    <div class="container">
        <div class="scan-line"></div>
        <h1>GÄ°ZLÄ° DOSYA: 1923</h1>

        <div id="statusBar" class="status-bar hidden">
            <span>AJAN: <span id="playerRole" class="role-badge">...</span></span>
            <span>GÃ–REV: <span id="levelIndicator">1</span>/4</span>
        </div>

        <div id="loginScreen" class="game-screen">
            <p style="margin-bottom: 20px; font-size: 1.1rem;">GÃœVENLÄ°K PROTOKOLÃœ BAÅLATILIYOR...</p>
            <p style="color: #666; font-size: 0.8rem; margin-bottom: 30px;">LÃ¼tfen kimlik doÄŸrulamasÄ± yapÄ±n.</p>
            
            <button onclick="selectRole('onur')" style="border-left: 5px solid #00e5ff;">BEN ONUR (SAHA AJANI)</button>
            <p style="font-size: 0.7rem; color:#444; margin: 5px 0 20px;">GÃ¶rev: Kilitleri aÃ§mak, bombalarÄ± imha etmek.</p>

            <button onclick="selectRole('ozlem')" style="border-left: 5px solid #d000ff;">BEN Ã–ZLEM (Ä°STÄ°HBARAT)</button>
            <p style="font-size: 0.7rem; color:#444; margin: 5px 0;">GÃ¶rev: Åifreleri Ã§Ã¶zmek, ajanÄ± yÃ¶nlendirmek.</p>
        </div>

        <div id="lobbyScreen" class="game-screen hidden">
            <h2 style="color: #fca311;">BAÄLANTI KURULUYOR...</h2>
            <p class="blink" style="margin-top: 20px; color: #888;">DiÄŸer ajan bekleniyor.</p>
            <p id="lobbyStatus" style="margin-top: 10px; font-size: 0.8rem; color: #00e5ff;">...</p>
        </div>

        <div id="gameContent" class="game-screen hidden">
            </div>

        <div id="victoryScreen" class="game-screen hidden">
            <h1 style="color: #00ff88; text-shadow: 0 0 20px #00ff88;">GÃ–REV BAÅARILI!</h1>
            <p>DÃ¼nyayÄ± kurtardÄ±nÄ±z ajanlar.</p>
            <p style="margin-top: 20px; color: #ccc;">Harika bir takÄ±msÄ±nÄ±z! ğŸ’œğŸ’™</p>
            <button onclick="location.reload()">YENÄ° GÃ–REV BAÅLAT</button>
        </div>

    </div>

    <script>
        // --- FIREBASE AYARLARI (Senin KodlarÄ±n) ---
        const firebaseConfig = {
          apiKey: "AIzaSyBHejjQe2dHnwDYES3Qd30HKO94-_D5lVA",
          authDomain: "ask-oyunu-5d368.firebaseapp.com",
          databaseURL: "https://ask-oyunu-5d368-default-rtdb.firebaseio.com",
          projectId: "ask-oyunu-5d368",
          storageBucket: "ask-oyunu-5d368.firebasestorage.app",
          messagingSenderId: "550862375128",
          appId: "1:550862375128:web:fb49cef5e3c5440d996fad",
          measurementId: "G-T1GCW04QD0"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const gameRef = db.ref('detective_game');

        // --- OYUN DEÄÄ°ÅKENLERÄ° ---
        let myRole = ""; // 'onur' veya 'ozlem'
        let currentLevel = 1;

        // --- 1. ROL SEÃ‡Ä°MÄ° ---
        function selectRole(role) {
            myRole = role;
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('lobbyScreen').classList.remove('hidden');
            
            document.getElementById('statusBar').classList.remove('hidden');
            document.getElementById('playerRole').innerText = role.toUpperCase();
            document.getElementById('playerRole').style.color = role === 'onur' ? '#00e5ff' : '#d000ff';

            // Firebase'e baÄŸlandÄ±ÄŸÄ±nÄ± bildir
            gameRef.child('players/' + role).set(true);

            // Oyunu dinle
            listenToGame();
        }

        // --- 2. OYUN DÃ–NGÃœSÃœ ---
        function listenToGame() {
            // Seviye takibi
            gameRef.child('level').on('value', (snapshot) => {
                const level = snapshot.val() || 1;
                currentLevel = level;
                document.getElementById('levelIndicator').innerText = level;

                // EÄŸer 5. seviyeye gelindiyse oyun bitti
                if (level > 4) {
                    showScreen('victoryScreen');
                } else {
                    renderLevel(level);
                }
            });

            // Lobi kontrolÃ¼ (Ä°ki oyuncu da geldi mi?)
            gameRef.child('players').on('value', (snapshot) => {
                const players = snapshot.val();
                if (players && players.onur && players.ozlem) {
                    // Ä°kisi de hazÄ±rsa oyunu baÅŸlat (seviye 1 deÄŸilse bile mevcut seviyeden devam et)
                    gameRef.child('level').get().then((snap) => {
                         if(!snap.exists()) gameRef.child('level').set(1);
                    });
                    showScreen('gameContent');
                } else {
                    document.getElementById('lobbyStatus').innerText = 
                        myRole === 'onur' ? "Ã–zlem bekleniyor..." : "Onur bekleniyor...";
                }
            });
        }

        function showScreen(screenId) {
            ['loginScreen', 'lobbyScreen', 'gameContent', 'victoryScreen'].forEach(id => {
                document.getElementById(id).classList.add('hidden');
            });
            document.getElementById(screenId).classList.remove('hidden');
        }

        // --- 3. SEVÄ°YE TASARIMLARI (Senaryolar) ---
        function renderLevel(level) {
            const container = document.getElementById('gameContent');
            container.innerHTML = ""; // Temizle

            let html = "";

            // ---------------------------------------------------------
            // SEVÄ°YE 1: RADYO FREKANSI
            // ---------------------------------------------------------
            if (level === 1) {
                if (myRole === 'ozlem') {
                    // Ã–zlem (Analist) GÃ¶rÃ¼nÃ¼mÃ¼
                    html = `
                        <div class="message-box analyst-view">
                            <h3>ğŸ“œ Ä°STÄ°HBARAT RAPORU #1</h3>
                            <p>DÃ¼ÅŸman sÄ±ÄŸÄ±naÄŸÄ±na sÄ±zdÄ±k. Ajan Onur bir radyo vericisi bulacak.</p>
                            <p>DoÄŸru frekans kodunu ona sÃ¶ylemelisin:</p>
                            <h2 style="color:#d000ff; text-align:center; font-size:2rem; margin-top:10px;">104.5 MHz</h2>
                            <p style="font-size:0.8rem; margin-top:10px;">(SakÄ±n yanlÄ±ÅŸ frekansÄ± ayarlamasÄ±na izin verme!)</p>
                        </div>
                        <p>AjanÄ±n frekansÄ± ayarlamasÄ±nÄ± bekle...</p>
                    `;
                } else {
                    // Onur (Ajan) GÃ¶rÃ¼nÃ¼mÃ¼
                    html = `
                        <div class="message-box agent-view">
                            <h3>ğŸ“» SAHA GÃ–REVÄ°</h3>
                            <p>Eski bir radyo cihazÄ± buldun. Sinyal karÄ±ÅŸtÄ±rÄ±lÄ±yor.</p>
                            <p>Ä°stihbarat ÅŸefine (Ã–zlem) sor: Hangi frekansa ayarlamalÄ±yÄ±m?</p>
                        </div>
                        <div class="radio-display" id="freqDisplay">88.0 MHz</div>
                        <input type="range" min="88" max="108" step="0.5" value="88" oninput="updateFreq(this.value)">
                        <button onclick="checkLevel1()">FREKANSI ONAYLA</button>
                    `;
                }
            }
            
            // ---------------------------------------------------------
            // SEVÄ°YE 2: ÅÄ°FRELÄ° KASA
            // ---------------------------------------------------------
            else if (level === 2) {
                if (myRole === 'ozlem') {
                    html = `
                        <div class="message-box analyst-view">
                            <h3>ğŸ“œ Ä°STÄ°HBARAT RAPORU #2</h3>
                            <p>Ajan kilitli bir kapÄ± buldu. Åifre, Cumhuriyetimizin ilan edildiÄŸi yÄ±ldÄ±r.</p>
                            <p>Ama dikkatli ol, ÅŸifreyi tersten girmesi gerekiyor!</p>
                            <h2 style="color:#d000ff; text-align:center; margin-top:10px;">Åifre: 1923</h2>
                            <p style="color:#ff3b3b; font-weight:bold; text-align:center;">GÄ°RÄ°LECEK KOD: 3291</p>
                        </div>
                        <p>AjanÄ±n ÅŸifreyi girmesini bekle...</p>
                    `;
                } else {
                    html = `
                        <div class="message-box agent-view">
                            <h3>ğŸ”’ DÄ°JÄ°TAL KÄ°LÄ°T</h3>
                            <p>KapÄ±da 4 haneli bir ÅŸifre paneli var.</p>
                            <p>Ã–zlem'e sor: Åifre nedir? (Ters girilmesi gerekebilir!)</p>
                        </div>
                        <input type="number" id="passcode" placeholder="____" maxlength="4">
                        <button onclick="checkLevel2()">KÄ°LÄ°DÄ° AÃ‡</button>
                    `;
                }
            }

            // ---------------------------------------------------------
            // SEVÄ°YE 3: BOMBA Ä°MHASI (KABLOLAR)
            // ---------------------------------------------------------
            else if (level === 3) {
                if (myRole === 'ozlem') {
                    html = `
                        <div class="message-box analyst-view">
                            <h3>ğŸ’£ BOMBA Ä°MHA KILAVUZU</h3>
                            <p>Sakin ol! Onur bir bomba mekanizmasÄ±yla karÅŸÄ± karÅŸÄ±ya.</p>
                            <p>TalimatlarÄ± sÄ±rasÄ±yla okumalÄ±sÄ±n:</p>
                            <ul style="margin-left:20px; margin-top:10px;">
                                <li>1. ASLA KÄ±rmÄ±zÄ± kabloyu kesme.</li>
                                <li>2. EÄŸer SarÄ± kablo varsa, Mavi kabloyu kes.</li>
                                <li>3. Sadece MAVÄ° kabloyu kesmelisin.</li>
                            </ul>
                        </div>
                        <p>AjanÄ±n doÄŸru kabloyu kesmesini bekle...</p>
                    `;
                } else {
                    html = `
                        <div class="message-box agent-view">
                            <h3>âš ï¸ TEHLÄ°KE: BOMBA</h3>
                            <p>ZamanlayÄ±cÄ± iÅŸliyor! Hangi kabloyu kesmeliyim?</p>
                            <p>Ã–zlem'in talimatlarÄ±nÄ± bekle. YanlÄ±ÅŸ kablo = BOOM.</p>
                        </div>
                        <div class="wires-container">
                            <div class="wire" style="background:red;" onclick="cutWire('red')"></div>
                            <div class="wire" style="background:blue;" onclick="cutWire('blue')"></div>
                            <div class="wire" style="background:yellow;" onclick="cutWire('yellow')"></div>
                            <div class="wire" style="background:green;" onclick="cutWire('green')"></div>
                        </div>
                        <p id="wireStatus" style="color:red; height:20px;"></p>
                    `;
                }
            }
            
            // ---------------------------------------------------------
            // SEVÄ°YE 4: SON DOÄRULAMA (SEVGÄ° TESTÄ°)
            // ---------------------------------------------------------
            else if (level === 4) {
                 if (myRole === 'ozlem') {
                    html = `
                        <div class="message-box analyst-view">
                            <h3>â¤ï¸ SON GÃœVENLÄ°K DUVARI</h3>
                            <p>Sistem son bir sesli doÄŸrulama istiyor.</p>
                            <p>Onur'a ÅŸunu sor: "Bizim sonsuzluk tarihimiz ne?"</p>
                            <p>CevabÄ± sen de girmelisin, o da girmeli!</p>
                            <h2 style="color:#d000ff; text-align:center;">17.03.2025</h2>
                        </div>
                        <input type="text" id="finalDate" placeholder="GG.AA.YYYY">
                        <button onclick="checkLevel4()">ONAYLA</button>
                    `;
                } else {
                    html = `
                        <div class="message-box agent-view">
                            <h3>â¤ï¸ SÄ°STEM KÄ°LÄ°DÄ°</h3>
                            <p>Ana bilgisayara eriÅŸtin. Son ÅŸifre "Sonsuzluk Tarihiniz".</p>
                            <p>Ã–zlem ile aynÄ± anda doÄŸru tarihi girmelisiniz.</p>
                        </div>
                        <input type="text" id="finalDate" placeholder="GG.AA.YYYY">
                        <button onclick="checkLevel4()">ONAYLA</button>
                    `;
                }
            }

            container.innerHTML = html;
        }

        // --- GÃ–REV KONTROL FONKSÄ°YONLARI (Onur iÃ§in) ---
        
        // Level 1: Radyo
        let currentFreq = 88;
        function updateFreq(val) {
            currentFreq = val;
            document.getElementById('freqDisplay').innerText = val + " MHz";
        }
        function checkLevel1() {
            if (currentFreq == 104.5) {
                nextLevel();
            } else {
                alert("HatalÄ± Frekans! Sinyal alÄ±namÄ±yor.");
            }
        }

        // Level 2: Åifre
        function checkLevel2() {
            const pass = document.getElementById('passcode').value;
            if (pass === "3291") {
                nextLevel();
            } else {
                alert("EriÅŸim Reddedildi! Åifre yanlÄ±ÅŸ.");
            }
        }

        // Level 3: Kablo
        function cutWire(color) {
            if (color === 'blue') {
                document.getElementById('wireStatus').innerText = "Bomba Ä°mha Edildi!";
                setTimeout(nextLevel, 1000);
            } else {
                alert("YANLIÅ KABLO! SÄ°STEM KÄ°LÄ°TLENDÄ°! (Tekrar dene)");
            }
        }

        // Level 4: Son Tarih (Her ikisi de basmalÄ±)
        function checkLevel4() {
            const date = document.getElementById('finalDate').value;
            if (date === "17.03.2025" || date === "17/03/2025") {
                // Burada basit bir hile yapÄ±yoruz, kim doÄŸru girerse seviyeyi bitirir.
                // Normalde ikisinin de onayÄ± beklenir ama tek dosya iÃ§in bu yeterli.
                nextLevel(); 
            } else {
                alert("Tarih eÅŸleÅŸmedi!");
            }
        }

        // --- SEVÄ°YE ATLAMA ---
        function nextLevel() {
            gameRef.child('level').transaction((current) => {
                return (current || 1) + 1;
            });
        }

    </script>
</body>
</html>