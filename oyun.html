<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dr. Mario Macera üçÑ</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;800&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; user-select: none; font-family: 'Poppins', sans-serif; }
        
        body {
            background: linear-gradient(180deg, #87CEEB 0%, #E0F7FA 100%); /* G√∂ky√ºz√º temasƒ± */
            overflow: hidden;
            touch-action: none;
        }

        #gameCanvas {
            display: block;
            width: 100%;
            height: 100%;
        }

        /* Aray√ºz */
        .ui-layer {
            position: absolute;
            top: 20px;
            left: 20px;
            pointer-events: none;
        }

        .score-box {
            background: rgba(255, 255, 255, 0.8);
            padding: 10px 20px;
            border-radius: 20px;
            border: 3px solid #ff9100;
            color: #d81b60;
            font-size: 1.5rem;
            font-weight: 800;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        /* Ba≈ülangƒ±√ß ve Biti≈ü Ekranlarƒ± */
        .screen {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            background: rgba(255, 255, 255, 0.9);
            padding: 40px;
            border-radius: 30px;
            border: 5px solid #bc13fe;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            max-width: 90%;
            width: 400px;
        }

        .hidden { display: none; }

        h1 { color: #bc13fe; margin-bottom: 10px; font-size: 2rem; }
        p { color: #555; margin-bottom: 20px; }

        button {
            background: linear-gradient(45deg, #ff4081, #ff80ab);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(255, 64, 129, 0.4);
            transition: transform 0.2s;
        }
        button:active { transform: scale(0.95); }

        .home-btn {
            position: absolute;
            top: 20px; right: 20px;
            background: white;
            padding: 10px 15px;
            border-radius: 50px;
            text-decoration: none;
            color: #bc13fe;
            font-weight: bold;
            box-shadow: 0 5px 10px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>

    <canvas id="gameCanvas"></canvas>

    <div class="ui-layer">
        <div class="score-box">Puan: <span id="scoreVal">0</span></div>
    </div>

    <a href="index.html" class="home-btn">üè† √áƒ±kƒ±≈ü</a>

    <div id="startScreen" class="screen">
        <h1>Dr. √ñzlem Ko≈üuyor! üèÉ‚Äç‚ôÄÔ∏è</h1>
        <p>Vir√ºslerin √ºst√ºnden zƒ±pla, kitaplarƒ± topla!</p>
        <p style="font-size:0.9rem; color:#888;">PC: Bo≈üluk Tu≈üu | Mobil: Dokun</p>
        <button onclick="startGame()">BA≈ûLA ‚ñ∂Ô∏è</button>
    </div>

    <div id="gameOverScreen" class="screen hidden">
        <h1 style="color:#ff3b3b;">Yandƒ±n! ü•∫</h1>
        <p>Skorun: <span id="finalScore" style="font-weight:bold; font-size:1.5rem;">0</span></p>
        <button onclick="startGame()">TEKRAR DENE üîÑ</button>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        let isPlaying = false;
        let frames = 0;
        let score = 0;
        let gameSpeed = 5;

        // Ekran Ayarlarƒ±
        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        // --- OYUN NESNELERƒ∞ ---

        // Zemin
        const ground = {
            y: 0,
            height: 100,
            color: '#4CAF50' // √áimen ye≈üili
        };

        // Oyuncu (Dr. √ñzlem)
        const player = {
            x: 50,
            y: 0,
            width: 50,
            height: 50,
            dy: 0,
            jumpPower: 18,
            gravity: 0.8,
            grounded: false,
            emoji: "üë©‚Äç‚öïÔ∏è"
        };

        // Engeller ve √ñd√ºller
        let obstacles = []; // Vir√ºsler
        let rewards = [];   // Kitaplar/ƒ∞la√ßlar

        // --- FONKSƒ∞YONLAR ---

        function startGame() {
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('gameOverScreen').classList.add('hidden');
            
            // Sƒ±fƒ±rla
            score = 0;
            frames = 0;
            gameSpeed = 6;
            obstacles = [];
            rewards = [];
            player.y = canvas.height - ground.height - player.height;
            player.dy = 0;
            isPlaying = true;
            
            document.getElementById('scoreVal').innerText = score;
            loop();
        }

        function jump() {
            if (player.grounded) {
                player.dy = -player.jumpPower;
                player.grounded = false;
            }
        }

        function update() {
            frames++;
            ground.y = canvas.height - ground.height;

            // 1. Oyuncu Fiziƒüi
            player.dy += player.gravity;
            player.y += player.dy;

            // Zemine √áarpma
            if (player.y + player.height >= ground.y) {
                player.y = ground.y - player.height;
                player.dy = 0;
                player.grounded = true;
            } else {
                player.grounded = false;
            }

            // 2. Engel Olu≈üturma (Vir√ºsler)
            // Her 90-150 karede bir rastgele engel at
            if (frames % Math.floor(Math.random() * 60 + 90) === 0) {
                obstacles.push({
                    x: canvas.width,
                    y: ground.y - 50, // Zeminde
                    width: 40,
                    height: 40,
                    emoji: "ü¶†"
                });
            }

            // 3. √ñd√ºl Olu≈üturma (Kitaplar) - Havada
            if (frames % Math.floor(Math.random() * 100 + 120) === 0) {
                // Rastgele y√ºkseklik (Zƒ±plama mesafesi i√ßinde)
                let randomH = Math.random() * 150 + 50; 
                rewards.push({
                    x: canvas.width,
                    y: ground.y - randomH, 
                    width: 30,
                    height: 30,
                    emoji: Math.random() > 0.5 ? "üìö" : "üíä"
                });
            }

            // 4. Hƒ±zlanma (Her 500 karede bir)
            if (frames % 500 === 0) gameSpeed += 0.5;

            // 5. Engelleri Hareket Ettir & Kontrol Et
            for (let i = 0; i < obstacles.length; i++) {
                let obs = obstacles[i];
                obs.x -= gameSpeed;

                // √áarpƒ±≈üma Kontrol√º (Oyun Biter)
                if (rectIntersect(player.x, player.y, player.width, player.height, obs.x + 10, obs.y + 10, obs.width - 20, obs.height - 20)) {
                    gameOver();
                }

                // Ekrandan √ßƒ±kƒ±nca sil
                if (obs.x + obs.width < 0) {
                    obstacles.splice(i, 1);
                    i--;
                    score += 1; // Engeli ge√ßince puan
                    document.getElementById('scoreVal').innerText = score;
                }
            }

            // 6. √ñd√ºlleri Hareket Ettir
            for (let i = 0; i < rewards.length; i++) {
                let rew = rewards[i];
                rew.x -= gameSpeed;

                // Toplama Kontrol√º
                if (rectIntersect(player.x, player.y, player.width, player.height, rew.x, rew.y, rew.width, rew.height)) {
                    score += 10; // Ekstra Puan
                    document.getElementById('scoreVal').innerText = score;
                    rewards.splice(i, 1);
                    i--;
                    continue;
                }

                if (rew.x + rew.width < 0) {
                    rewards.splice(i, 1);
                    i--;
                }
            }
        }

        function draw() {
            // Arka Plan Temizle
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Zemin √áiz (Mario tarzƒ± bloklar)
            ctx.fillStyle = ground.color;
            ctx.fillRect(0, ground.y, canvas.width, ground.height);
            // Zemin detayƒ± (toprak)
            ctx.fillStyle = "#795548";
            ctx.fillRect(0, ground.y + 20, canvas.width, ground.height - 20);

            // Oyuncu √áiz
            ctx.font = "50px Arial";
            ctx.fillText(player.emoji, player.x, player.y + 45);

            // Engelleri √áiz
            for (let obs of obstacles) {
                ctx.font = "40px Arial";
                ctx.fillText(obs.emoji, obs.x, obs.y + 35);
            }

            // √ñd√ºlleri √áiz
            for (let rew of rewards) {
                ctx.font = "30px Arial";
                ctx.fillText(rew.emoji, rew.x, rew.y + 25);
            }
        }

        function gameOver() {
            isPlaying = false;
            document.getElementById('finalScore').innerText = score;
            document.getElementById('gameOverScreen').classList.remove('hidden');
        }

        function loop() {
            if (isPlaying) {
                update();
                draw();
                requestAnimationFrame(loop);
            }
        }

        // Basit √áarpƒ±≈üma Testi
        function rectIntersect(x1, y1, w1, h1, x2, y2, w2, h2) {
            return x2 < x1 + w1 && x2 + w2 > x1 && y2 < y1 + h1 && y2 + h2 > y1;
        }

        // KONTROLLER
        window.addEventListener('keydown', (e) => {
            if (e.code === 'Space' || e.code === 'ArrowUp') jump();
        });

        window.addEventListener('touchstart', (e) => {
            jump();
        });

        window.addEventListener('mousedown', (e) => {
            jump();
        });

    </script>
</body>
</html>